<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Busca de M√∫sicas - Repert√≥rio</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    input[type="text"] {
      width: 300px;
      padding: 8px;
      font-size: 16px;
    }
    button {
      padding: 8px 12px;
      font-size: 16px;
    }
    table {
      margin-top: 20px;
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
    }
    th {
      background-color: #f4f4f4;
    }
  </style>
</head>
<body>

  <h2>Buscar M√∫sica no Repert√≥rio</h2>
  <input type="text" id="searchInput" placeholder="Digite o nome da m√∫sica1..">
  <button id="searchButton">Pesquisar</button>

  <table id="resultTable" style="display:none;">
    <thead>
      <tr>
        <th>Classifica√ß√£o</th>
        <th>Ritmo</th>
        <th>M√∫sica</th>
        <th>Cantor/Banda Original</th>
        <th>Vers√£o</th>
        <th>Tom Original</th>
        <th>Tom (Izaack)</th>
        <th>Tom (Victor)</th>
        <th>Tom (Kalebe)</th>
        <th>Tom Feminino</th>
        <th>YouTube</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const input = document.getElementById("searchInput");
    const tabela = document.getElementById("resultTable");
    const corpoTabela = tabela.querySelector("tbody");
    const searchButton = document.getElementById("searchButton");

    const url = "https://opensheet.elk.sh/2PACX-1vT3nfCybgcT4p5fAFEV_YRn88r9R-bxatOi96UqXvI6CVb_QRc1hoVFz6YXhlafiX0lfZgTR4suVA93/REPERTORIO";

    function removerAcentos(str) {
      return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase();
    }

    function buscarMusica() {
      const termo = removerAcentos(input.value.trim());
      if (termo === "") return;
      corpoTabela.innerHTML = "";

      fetch(url)
        .then(res => {
          if (!res.ok) throw new Error("Erro ao buscar os dados da planilha.");
          return res.json();
        })
        .then(musicas => {
          const resultado = musicas.filter(item => {
            const nomeMusica = item["M√∫sica"] ? removerAcentos(item["M√∫sica"]) : "";
            return nomeMusica.includes(termo);
          });

          if (resultado.length > 0) {
            resultado.forEach(item => {
              const row = `
                <tr>
                  <td>${item["Classifica√ß√£o"] || ''}</td>
                  <td>${item["Ritmo"] || ''}</td>
                  <td>${item["M√∫sica"] || ''}</td>
                  <td>${item["Cantor/Banda Original"] || ''}</td>
                  <td>${item["Vers√£o"] || ''}</td>
                  <td>${item["Tom Original"] || ''}</td>
                  <td>${item["Tom Masculino (Izaack)"] || ''}</td>
                  <td>${item["Tom Masculino (Victor)"] || ''}</td>
                  <td>${item["Tom Masculino (Kalebe)"] || ''}</td>
                  <td>${item["Tom Feminino"] || ''}</td>
                  <td><a href="${item["Link do YouTube (vers√£o)"]}" target="_blank">üîó</a></td>
                </tr>
              `;
              corpoTabela.innerHTML += row;
            });
            tabela.style.display = "table";
          } else {
            tabela.style.display = "none";
            alert("Nenhuma m√∫sica encontrada.");
          }
        })
        .catch(error => {
          console.error("Erro ao buscar dados:", error);
          alert("Erro ao buscar os dados. Verifique se a planilha est√° publicada corretamente.");
        });
    }

    searchButton.addEventListener("click", buscarMusica);
    input.addEventListener("keydown", (e) => {
      if (e.key === "Enter") buscarMusica();
    });
    window.addEventListener("load", () => {
      input.value = "";
    });
  </script>

</body>
</html>
